# 魔王ダンジョン・プロトタイプ

このリポジトリは、2Dダンジョン・マネジメント型ゲームの試作コードをまとめたものです。勇者の侵攻を魔物の生態系で迎え撃つ構造を軸に設計されています。

## ディレクトリ構成

```
├── data/                     # ゲーム用各種データ
│   ├── game_config.json         ← ゲーム全体設定
│   ├── hero_parties.json        ← 勇者パーティ編成
│   ├── heroes.json              ← 職業定義・セリフ構成
│   ├── map.json                 ← 地形・資源構成
│   ├── layered_map.json         ← レイヤー付きマップサンプル
│   ├── monsters.json            ← 魔物ID・種族構成
│   └── monsters_detailed.json   ← 魔物詳細パラメータ
│
├── lib/                      # 補助処理
│   ├── resourceManager.js       ← 資源循環ロジック
│   └── utils.js                 ← 共通ユーティリティ
│
├── scenes/                   # 画面HTML
│   ├── game.html                ← メインUI
│   ├── hero_invade.html         ← 勇者侵攻モードUI
│   ├── monster_canvas.html      ← 魔物配置モードUI
│   ├── layered_map.html         ← レイヤー構造マップ表示
│   └── index.html               ← ランチャー画面
│
├── scripts/                 # ゲーム制御スクリプト
│   ├── game.js                  ← ゲーム状態管理
│   ├── turn_manager.js          ← フェーズ・wave制御
│   ├── hero_ai.js               ← 勇者探索AI
│   ├── map_renderer.js          ← マップ描画
│   ├── layered_map_renderer.js  ← レイヤーマップ描画
│   └── monster_canvas.js        ← 魔物配置処理
│
├── assets/                # 画像アセット
│   ├── backgrounds/          ← 背景画像用
│   ├── characters/           ← キャラクター画像用
│   ├── monsters/             ← モンスター画像用
│   └── ui/                   ← UI素材用
│
├── styles/                 # 共通スタイル
│   └── styles.css               ← 画面用スタイル
```

## 基本仕様メモ

- **ターン制 / wave構造**
  - プレイヤーは準備フェーズで魔物を配置し、勇者はwave単位で侵攻します。
  - 各waveは「勇者チーム出発 → 撃退または勝利」で進行し、全waveをしのげばステージクリアとなります。
- **生態系ピラミッドとリソース循環**
  - 魔物は下位 → 中位 → 上位へ捕食・吸収し成長します。
  - 死骸や捕食により養分・魔分が還元され、マップ全体の魔力は原則保存されます。
- **初期コストと魔力増加**
  - wave開始前に配布される初期コストが主な魔力源です。
  - 勇者を倒すと持ち込み魔力がマップへ還元され、成長加速が可能になります。
- **勇者AIと探索ロジック**
  - 右手法ベースに記憶を持たせた探索を行います。
  - 勇者はパーティ単位で行動し、代表キャラが探索・戦闘を実行します。

## 実行方法

ブラウザで`scenes/title.html`を開くとタイトル画面が表示されます。セーブデータがあれば「つづきから」で再開できます。開発中のため、ローカルの簡易HTTPサーバなどで公開すると動作確認しやすくなります。

`scenes/index.html`では開発用ランチャーを利用できます。

`scenes/layered_map.html`を開くと、レイヤー構造を用いたマップ描画サンプルを確認できます。

## 今後の追加予定

- 各JSON構造の詳細な仕様ドキュメント
- 魔物ごとの進化アルゴリズム（詳しくは`docs/evolution.md`参照）
- 魔素循環と死骸処理（`docs/resource_cycle.md`参照）
- UI演出強化（セリフ、エフェクト、地形変化）
- 勇者イベントスクリプト・ボスパターン設計

